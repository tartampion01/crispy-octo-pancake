function fetchRecords(n,r,s,e,l){$(".loading-overlay").show();var o=1;o="undefined"!=typeof $pagination&&0==e?$pagination.twbsPagination("getCurrentPage"):1;var c=$(".GpcPagerCountSelector").children("div.selected").html(),t=$(".search-sorting option:selected").val();3!=l&&4!=l||(l=2);var a={field:n,value:r,customCriteria:s,sortBy:t,currentPage:o,limitPerPage:c,arrayFilters:getSearchTerms()};$.ajax({url:"http://reseaudynamique.com/api/read.php?n="+l,type:"GET",data:"params="+JSON.stringify(a),dataType:"json",async:!0,success:function(e){if(null!=e.records)if(0<e.records.length){$(".results-container").empty(),$("#resultsTemplate").tmpl(e.records).appendTo(".results-container");var t=Math.ceil(e.countRows/c);$(".GpcPagedResultTotalCount").html(e.countRows),c>e.countRows&&(c=e.countRows);var a="";a=1==o?"1 - "+c:o==t?parseInt(c*o-c+1)+" - "+parseInt(e.countRows):parseInt(c*o-c+1)+" - "+parseInt(c*o),$(".GpcPagedResultCurrentCount").html(a),$(".GpcPagedResultCount").show(),$pagination=$(".pagination"),$pagination.twbsPagination("destroy"),$pagination.twbsPagination($.extend({},{startPage:o,totalPages:t,visiblePages:5,first:"&lt;&lt;",prev:"Précédent",next:"Suivant",last:"&gt;&gt;",initiateStartPageClick:!1,onPageClick:function(e,t){fetchRecords(n,r,s,!1,l);var a=".GpcMenuWrapper";"640px"==maxwidth&&(a=".GpcPagedResultCount"),$("html, body").animate({scrollTop:$(a).offset().top},750)}})),$(".GpcMenuCategory").each(function(){var e=$(this).find(".filter-link:first").data("field"),t=$(this).find(".filter-link:first").data("custom-criteria"),a={field:e,value:r,customCriteria:t,searchType:n,arrayFilters:getSearchTerms()};$.ajax({url:"http://reseaudynamique.com/api/read-count-filter.php?n="+l,type:"GET",data:"params="+JSON.stringify(a),dataType:"json",async:!1,success:function(t){Object.keys(t).length&&$(".GpcMenuCategory").find('.filter-link[data-field="'+e+'"]').each(function(e){for($(this).hide(),i=0;i<t.length;i++)-1<Object.values(t[i]).indexOf($(this).attr("data-value").replace("%2B","+"))&&($(this).find(".GpcMenuItemCount").html("("+t[i].count+")"),$(this).show())})}})})}else $(".results-container").html("AUCUN PRODUIT"),$(".GpcPagedResultCount").show();else $(".results-container").html(e.message),$(".GpcPagedResultCount").show();$(".loading-overlay").hide()},error:function(e,t,a){$(".results-container").html(a)}})}function getSearchTerms(){var i=[];return $(".GpcMenuCategory .filter-link.selected").each(function(){var e=$(this).parents("ul").attr("class"),t=$(this).attr("data-value"),a={};a.field=e,a.value=t,i.push(a),0}),i}function refreshPagination(){$(".pagination").empty(),$(".pagination").removeData("twbs-pagination"),$(".pagination").unbind("page")}$(document).ready(function(){1!=_N&&0!=_N&&2!=_N&&3!=_N&&4!=_N&&(_N=1),maxwidth=$("html").css("max-width"),$(".filter-link").each(function(){$(this).on("click",function(){if(1==$(this).data("selected")){$(this).data("selected",!1),$(this).removeClass("selected");var e="";$(".GpcMenuCategory .filter-link.selected").each(function(){""==e&&(e=$(this).data("custom-criteria"))}),""==e&&(e=1==_N?' (marque="international" AND DisplayOnWebSite=1) or (marque="isuzu" AND DisplayOnWebSite=1) or marque="kalmar" AND ':2==_N?' engine="-" AND (marque="doepker" or marque="di-mond" or marque="asetrail") AND ':3==_N?' engine="-" AND marque="di-mond" AND ':4==_N?' engine="-" AND marque="doepker" AND ':""),3!=_N&&4!=_N||(_N=2),fetchRecords("","",e,!0,_N)}else{$(this).addClass("selected"),$(this).data("selected",!0),fetchRecords($(this).attr("data-field"),$(this).attr("data-value"),e=$(this).data("custom-criteria"),!0,_N)}})}),$(".limit-per-page").on("click",function(){$(".limit-per-page").removeClass("selected"),$(this).addClass("selected");var e=$(".GpcMenu").find("li.selected").data("field"),t=$(".GpcMenu").find("li.selected").data("value"),a=$(".GpcMenu").find("li.selected").data("custom-criteria");null==e&&(e=""),null==t&&(t=""),null==a&&(a=1==_N?' (marque="international" AND DisplayOnWebSite=1) or (marque="isuzu" AND DisplayOnWebSite=1) or marque="kalmar" AND ':2==_N?' engine="-" AND (marque="doepker" or marque="di-mond" or marque="asetrail") AND ':3==_N?' engine="-" AND marque="di-mond" AND ':4==_N?' engine="-" AND marque="doepker" AND ':""),3!=_N&&4!=_N||(_N=2),fetchRecords(e,t,a,!0,_N)}),$(".search-sorting").on("change",function(){var e=$(".GpcMenu").find("li.selected").data("field"),t=$(".GpcMenu").find("li.selected").data("value"),a=$(".GpcMenu").find("li.selected").data("custom-criteria");null==e&&(e=""),null==t&&(t=""),null==a&&(a=1==_N?' (marque="international" AND DisplayOnWebSite=1) or (marque="isuzu" AND DisplayOnWebSite=1) or marque="kalmar" AND ':2==_N?' engine="-" AND (marque="doepker" or marque="di-mond" or marque="asetrail") AND ':3==_N?' engine="-" AND marque="di-mond" AND ':4==_N?' engine="-" AND marque="doepker" AND ':""),3!=_N&&4!=_N||(_N=2),fetchRecords(e,t,a,!0,_N)})}),$(window).on("resize",function(){maxwidth=$("html").css("max-width")});